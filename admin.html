<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administra√ß√£o - Chamador de Senhas</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/admin.css" rel="stylesheet">
    <script src="lib/jquery-3.3.1.min.js"></script>
</head>
<body>
    <div id="navbar-container"></div>
    
    <!-- Tela de Login -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <img src="imagens/pjf_logo.png" class="login-logo">
                <h2>üîí Acesso Administrativo</h2>
                <p>Digite a senha para acessar a administra√ß√£o</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="input-group">
                    <input type="password" id="passwordInput" placeholder="Senha de acesso" required>
                    <button type="submit" class="btn-login">Entrar</button>
                </div>
                <div id="loginError" class="login-error" style="display: none;">
                    ‚ùå Senha incorreta! Tente novamente.
                </div>
            </form>
        </div>
    </div>

    <!-- Conte√∫do Principal (inicialmente oculto) -->
    <div id="adminContent" style="display: none;">
        <div class="barraTop">&nbsp;</div>
    
    <div class="container page">
        <!-- Barra Superior -->
        <div class="row barraSuperior">
            <div class="col-xs-1">
                <img src="imagens/pjf_logo.png" class="PJFLogo">
            </div>
            <div class="col-xs-11" style="text-align: right;">
                <span class="PJFTexto">PREFEITURA MUNICIPAL DE JUIZ DE FORA</span><br>
                <span class="subtitulo">Administra√ß√£o do Sistema - <strong>Chamador de Senhas</strong></span>
            </div>
        </div>

        <!-- Se√ß√£o de Upload -->
        <div class="row admin-section">
            <div class="col-xs-12">
                <h2 class="admin-title">üìÅ Gerenciar Arquivos Excel</h2>
                <p class="admin-description">Fa√ßa upload dos arquivos Excel com as listas de convocados para cada categoria.</p>
                
                <!-- √Årea de Upload -->
                <div class="upload-area">
                    <div class="upload-zone" id="uploadZone">
                        <div class="upload-icon">üìé</div>
                        <p>Clique aqui ou arraste os arquivos Excel (.xlsx)</p>
                        <input type="file" id="fileInput" accept=".xlsx,.xls" multiple style="display: none;">
                        <button class="btn-upload" onclick="document.getElementById('fileInput').click()">
                            Selecionar Arquivos
                        </button>
                    </div>
                </div>

                <!-- Lista de Arquivos Carregados -->
                <div class="files-section">
                    <h3>üìã Arquivos Configurados</h3>
                    <div id="filesList" class="files-list">
                        <!-- Arquivos ser√£o listados aqui dinamicamente -->
                    </div>
                </div>

                <!-- Se√ß√£o de Mapeamento -->
                <div class="mapping-section">
                    <h3>üîó Associar Arquivos √†s P√°ginas</h3>
                    <div id="mappingContainer" class="mapping-container">
                        <!-- Mapeamentos ser√£o exibidos aqui -->
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="action-buttons">
                    <button class="btn btn-primary" id="saveConfig">üíæ Salvar Configura√ß√µes</button>
                    <button class="btn btn-secondary" id="resetConfig">üîÑ Resetar</button>
                    <button class="btn btn-success" id="testConfig">üß™ Testar Sistema</button>
                </div>

                <!-- Status/Log -->
                <div class="status-section">
                    <h3>üìä Status do Sistema</h3>
                    <div id="statusLog" class="status-log">
                        <p class="status-item success">‚úÖ Sistema iniciado</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Configura√ß√£o -->
        <div id="configModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>‚öôÔ∏è Configurar Arquivo</h3>
                <div id="modalContent">
                    <!-- Conte√∫do do modal ser√° preenchido dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    </div> <!-- Fim do adminContent -->

    <script>
        // Sistema de autentica√ß√£o
        const correctPassword = "mg@123";
        
        // Verifica se j√° est√° logado (sess√£o)
        if (sessionStorage.getItem("adminAuthenticated") === "true") {
            document.getElementById("loginScreen").style.display = "none";
            document.getElementById("adminContent").style.display = "block";
        }
        
        // Handler do formul√°rio de login
        document.getElementById("loginForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const password = document.getElementById("passwordInput").value;
            const errorDiv = document.getElementById("loginError");
            
            if (password === correctPassword) {
                // Senha correta - salva na sess√£o e mostra o conte√∫do
                sessionStorage.setItem("adminAuthenticated", "true");
                document.getElementById("loginScreen").style.display = "none";
                document.getElementById("adminContent").style.display = "block";
                errorDiv.style.display = "none";
            } else {
                // Senha incorreta
                errorDiv.style.display = "block";
                document.getElementById("passwordInput").value = "";
                document.getElementById("passwordInput").focus();
            }
        });
        
        // Logout quando fechar a aba/navegador
        window.addEventListener("beforeunload", function() {
            sessionStorage.removeItem("adminAuthenticated");
        });
    </script>
    <script src="lib/admin.js"></script>
</body>
</html>
